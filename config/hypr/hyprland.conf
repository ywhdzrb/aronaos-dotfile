# #######################################################################################
# 我的个人配置
# ywhdzrb 著
# #######################################################################################

autogenerated = 0 # 移除此行可删除警告信息

# 更多信息请参考 Wiki：
# https://wiki.hypr.land/Configuring/

# 请注意，此处未设置所有可用的设置/选项
# 完整列表请参阅 Wiki

# 您可以将此配置拆分为多个文件
# 分别创建文件后，通过如下方式链接到本文件：
# source = ~/.config/hypr/myColors.conf


################
### 显示器设置 ###
################

# 参见：https://wiki.hypr.land/Configuring/Monitors/
monitor=,preferred,auto,auto # 自动检测并使用首选显示器设置


###################
### 我的程序设置 ###
###################

# 参见：https://wiki.hypr.land/Configuring/Keywords/

# 设置您常用的程序
$terminal = kitty        # 终端程序
$fileManager = thunar    # 文件管理器
#$menu = wofi --show drun -I  # 应用启动器
$menu = rofi -show drun -no-config -theme ~/.config/hypr/menu.rasi  # 应用启动器
$browser = firefox      # 浏览器
$code = code        # 代码编辑器

#############################
### 环境配置 ###
#############################

# 请看 https://wiki.hypr.land/Configuring/Environment-variables/

env = XCURSOR_SIZE,24
env = HYPRCURSOR_SIZE,40
env = HYPRCURSOR_THEME,Future-Cyan-Hyprcursor_Theme
env = QT_QPA_PLATFORM,wayland
env = QT_QPA_PLATFORMTHEME,qt6ct
env = XDG_MENU_PREFIX, arch-

# 初始化关键后台服务
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP=hyprland
exec-once = systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP

# -------------------------------
# 启动核心组件
# -------------------------------
# 启动 swww 壁纸守护进程并设置初始壁纸 （静态）
exec-once = swww-daemon #--format-xrgb # 推荐使用 --format-xrgb 以获得更好的色彩兼容性
exec-once = sleep 1 && swww img ~/wallpaper/14.png # 设置静态壁纸，延迟1秒确保daemon已启动

# 启动 mpvpaper 设置动态壁纸
# exec-once = mpvpaper -o "no-audio loop-file" eDP-1 "~/wallpaper/Rei Ayanami.mp4"

# 启动 Waybar 状态栏
exec-once = waybar

# 启动 Dunst 通知守护进程
exec-once = dunst

# 启动 Polkit 认证代理
exec-once = /usr/lib/polkit-kde-authentication-agent-1

exec-once = fcitx5 -d --replace

#启动粘贴板历史
exec-once = wl-paste --type text --watch cliphist store # 存储文本
exec-once = wl-paste --type image --watch cliphist store # 存储图像
# exec-once = copyq --start-server

# 挂起windows硬盘
# exec-once = sudo mkdir /run/media/C && sudo mount /dev/sda3 /run/media/C 

# 启动网络管理器
exec-once = nm-applet --indicator --no-agent

###################
### 权限配置 ###
###################

# 权限系统配置
# 参见 https://wiki.hypr.land/Configuring/Permissions/
# 请注意：此处的权限更改需要重启 Hyprland 才能生效，不会实时应用
# 这是出于安全考虑的设计

# 生态系统权限强制执行（1=启用，0=禁用）
# ecosystem {
#   enforce_permissions = 1
# }

# 具体权限规则示例（已注释掉）：
# 允许 grim 截图工具进行屏幕复制操作
# permission = /usr/(bin|local/bin)/grim, screencopy, allow

# 允许 xdg-desktop-portal-hyprland 进行屏幕复制操作
# permission = /usr/(lib|libexec|lib64)/xdg-desktop-portal-hyprland, screencopy, allow

# 允许 hyprpm 包管理器使用插件功能
# permission = /usr/(bin|local/bin)/hyprpm, plugin, allow


#####################
### 外观和感觉 ###
#####################

# 外观和感觉相关配置
# 参考 https://wiki.hypr.land/Configuring/Variables/

# 通用设置
general {
    # 窗口之间的间隙（像素）
    gaps_in = 2.5
    # 窗口与屏幕边缘之间的间隙（像素）
    gaps_out = 5

    # 窗口边框大小（像素）
    border_size = 1

    # 颜色设置说明参见：https://wiki.hypr.land/Configuring/Variables/#variable-types
    # 活动窗口边框颜色（45deg 表示45度渐变）
    col.active_border = rgba(33ccffee) rgba(00ff99ee) 45deg
    # 非活动窗口边框颜色
    col.inactive_border = rgba(595959aa)

    # 设置为 true 可通过点击并拖动边框和间隙来调整窗口大小
    resize_on_border = true

    # 启用撕裂效果（在开启前请阅读：https://wiki.hypr.land/Configuring/Tearing/）
    allow_tearing = false

    # 默认布局（dwindle 或 master）
    layout = dwindle
}

# 装饰效果设置（如圆角、阴影、模糊等）
# 参见：https://wiki.hypr.land/Configuring/Variables/#decoration
decoration {
    # 窗口圆角半径（像素）
    rounding = 4
    # 圆角渲染质量/性能平衡（越高质量越好，但性能开销越大）
    rounding_power = 2

    # 更改焦点窗口和非焦点窗口的不透明度
    active_opacity = 1.0
    inactive_opacity = 1.0

    # 阴影设置
    shadow {
        # 是否启用阴影
        enabled = false
        # 阴影范围（像素）
        range = 4
        # 阴影渲染强度
        render_power = 3
        # 阴影颜色
        color = rgba(1a1a1aee)
    }

    # 模糊效果设置
    # 参见：https://wiki.hypr.land/Configuring/Variables/#blur
    blur {
        # 是否启用模糊
        enabled = true
        # 模糊大小
        size = 3
        # 模糊渲染次数（ passes ）
        passes = 1

        # 色彩鲜艳度（增强模糊背景的饱和度）
        vibrancy = 0.1696
    }
}

# 动画效果设置
# 参见：https://wiki.hypr.land/Configuring/Variables/#animations
animations {
    enabled = yes

    # -------------- 贝塞尔 --------------
    bezier = easeOutQuint,0.23,1,0.32,1
    bezier = easeInOutCubic,0.65,0.05,0.36,1
    bezier = linear,         0,0,1,1
    bezier = almostLinear,   0.5,0.5,0.75,1.0
    bezier = quick,          0.15,0,0.1,1

    # -------------- 窗口 --------------
    animation = windows,      1, 3, quick
    animation = windowsIn,    1, 2.2, quick, popin 0%
    animation = windowsOut,   1, 2.2, quick, popin 0%

    # -------------- 边框 / 淡入淡出 --------------
    animation = border,       1, 2.5, easeOutQuint
    animation = fade,         1, 2.5, quick
    animation = fadeIn,       1, 2.2, quick
    animation = fadeOut,      1, 2.2, quick

    # -------------- 图层（浮动、OSD） --------------
    animation = layers,       1, 2.8, quick
    animation = layersIn,     1, 2.5, quick, fade
    animation = layersOut,    1, 2.2, quick, fade
    animation = fadeLayersIn, 1, 2.2, quick
    animation = fadeLayersOut,1, 2.0, quick

    # -------------- 工作区 --------------
    animation = workspaces,     1, 3, quick, slide
    animation = workspacesIn,   1, 3, quick, slide
    animation = workspacesOut,  1, 3, quick, slide
}

# 工作区规则配置
# 参考：https://wiki.hypr.land/Configuring/Workspace-Rules/
# “智能间隙” / “仅有一个窗口时无间隙”
# 如果您希望使用此功能，请取消注释以下所有行
# workspace = w[tv1], gapsout:0, gapsin:0          # 在工作区 'tv1' 上禁用所有间隙
# workspace = f[1], gapsout:0, gapsin:0            # 在浮动工作区 1 上禁用所有间隙
# windowrule = bordersize 0, floating:0, onworkspace:w[tv1] # 在 'tv1' 工作区上禁用非浮动窗口的边框
# windowrule = rounding 0, floating:0, onworkspace:w[tv1]   # 在 'tv1' 工作区上禁用非浮动窗口的圆角
# windowrule = bordersize 0, floating:0, onworkspace:f[1]   # 在浮动工作区 1 上禁用非浮动窗口的边框
# windowrule = rounding 0, floating:0, onworkspace:f[1]     # 在浮动工作区 1 上禁用非浮动窗口的圆角

# Dwindle 布局配置
# 参见：https://wiki.hypr.land/Configuring/Dwindle-Layout/ 获取更多信息
dwindle {
    pseudotile = true
    preserve_split = true
    # 确保没有强制分割方向，让系统自动判断
    force_split = 0
    # 启用智能分割
    smart_split = false
    smart_resizing = true
    # 分割线渲染
    split_width_multiplier = 1.0
    # 使用鼠标调整分割区域
    # no_gaps_when_only = false
}

# Master 布局配置
# 参见：https://wiki.hypr.land/Configuring/Master-Layout/ 获取更多信息
master {
    new_status = master # 新窗口的初始状态（master 或 slave）
}

# 杂项设置
# https://wiki.hypr.land/Configuring/Variables/#misc
misc {
    force_default_wallpaper = 0
    disable_hyprland_logo = true
    
    # 确保拖拽功能启用
    enable_swallow = true
    swallow_regex = ^(kitty)$
    
    # 拖拽相关设置
    mouse_move_enables_dpms = true
    focus_on_activate = true
    # no_direct_scanout = true
    
    # 新窗口分割行为
    new_window_takes_over_fullscreen = 2
    
    # 确保禁用动画干扰拖拽
    disable_autoreload = true
}



# 光标设置
#cursor {
#    hyprcursor = true # 确保启用 hyprcursor
#    hyprcursor_theme = Future-Cyan-Hyprcursor_Theme  # 安装的主题文件夹名称
#    hyprcursor_size = 24 # 光标大小
#}

#############
### 输入 & 触摸板
#############

# https://wiki.hypr.land/Configuring/Variables/#input
input {
    kb_layout = us
    kb_variant =
    kb_model =
    kb_options =
    kb_rules =

    follow_mouse = 1
    sensitivity = 0          # 鼠标不动速度

    touchpad {
        natural_scroll        = true   # 自然滚动
        tap-to-click          = true   # 轻点即点击
        drag_lock             = false  # 拖锁（按需）
        scroll_factor         = 1.0    # 滚动速度
        clickfinger_behavior  = true   # 1/2/3 指对应左/右/中
        disable_while_typing  = false   # 打字禁用
        middle_button_emulation = false
    }
}


# https://wiki.hypr.land/Configuring/Variables/#gestures
#############
### 触摸板手势
#############
gestures {
    #workspace_swipe = true
}

# 给特定设备单独设配置示例
# 详见 https://wiki.hypr.land/Configuring/Keywords/#per-device-input-configs
device {
    name = epic-mouse-v1    # 只针对名字叫“epic-mouse-v1”的鼠标
    sensitivity = -0.5      # 把它的速度再放慢一半
}


# -------------------------------
# 键位绑定 (SUPER 键通常是 Win 键)
# -------------------------------
$mainMod = SUPER

# 应用启动器 Wofi
bind = $mainMod, D, exec, $menu # 显示应用列表

# 终端 Kitty
bind = $mainMod, RETURN, exec, $terminal

# firefox
bind = $mainMod, S, exec, $browser

# 文件管理器
bind = $mainMod, E, exec, $fileManager

# 粘贴版历史
bind = SUPER, V, exec, cliphist list | rofi -dmenu -i -p '' -theme ~/.config/hypr/cliphist_menu.rasi | xargs -r -I{} cliphist decode {} | wl-copy

# code
bind = SUPER, C, exec, $code

# 其他常用软件
# QQ
bind = SUPER, A, exec, linuxqq

# 微信
bind = SUPER, W, exec, wechat.sh

# Clash Verge
bind = SUPER, H, exec, clash-verge

# qq音乐
bind = SUPER, M, exec, qqmusic

# 关闭当前窗口
bind = $mainMod, Q, killactive,

# 切换浮动窗口
bind = $mainMod, F, togglefloating,

# 切换全屏
bind = $mainMod, U, fullscreen,

# 改变窗口焦点
bind = $mainMod, left, movefocus, l
bind = $mainMod, right, movefocus, r
bind = $mainMod, up, movefocus, u
bind = $mainMod, down, movefocus, d

# 布局控制 - 分割方向
bind = $mainMod, P, pseudo, # dwindle 伪平铺
bind = $mainMod, J, togglesplit, # 切换分割方向（左右/上下）
bind = $mainMod SHIFT, H, layoutmsg, orientationleft # 强制左右分割
bind = $mainMod SHIFT, V, layoutmsg, orientationtop # 强制上下分割

# 切换工作区
bind = $mainMod, 1, workspace, 1
bind = $mainMod, 2, workspace, 2
bind = $mainMod, 3, workspace, 3
bind = $mainMod, 4, workspace, 4
bind = $mainMod, 5, workspace, 5
bind = $mainMod, 6, workspace, 6
bind = $mainMod, 7, workspace, 7
bind = $mainMod, 8, workspace, 8
bind = $mainMod, 9, workspace, 9
bind = $mainMod, 0, workspace, 10

# 移动窗口到工作区
bind = $mainMod SHIFT, 1, movetoworkspace, 1
bind = $mainMod SHIFT, 2, movetoworkspace, 2
bind = $mainMod SHIFT, 3, movetoworkspace, 3
bind = $mainMod SHIFT, 4, movetoworkspace, 4
bind = $mainMod SHIFT, 5, movetoworkspace, 5
bind = $mainMod SHIFT, 6, movetoworkspace, 6
bind = $mainMod SHIFT, 7, movetoworkspace, 7
bind = $mainMod SHIFT, 8, movetoworkspace, 8
bind = $mainMod SHIFT, 9, movetoworkspace, 9
bind = $mainMod SHIFT, 0, movetoworkspace, 10

# 滚动浏览工作区
bind = $mainMod, mouse_down, workspace, e+1
bind = $mainMod, mouse_up, workspace, e-1

# 鼠标移动/调整窗口
bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow

# 屏幕亮度控制
bind = , XF86MonBrightnessUp, exec, ~/.config/hypr/backlight --inc
bind = , XF86MonBrightnessDown, exec, ~/.config/hypr/backlight --dec

# 音量控制
bind = , XF86AudioRaiseVolume, exec, ~/.config/hypr/volume --inc
bind = , XF86AudioLowerVolume, exec, ~/.config/hypr/volume --dec
bind = , XF86AudioMute, exec, ~/.config/hypr/volume --toggle
bind = , XF86AudioPlay, exec, playerctl play-pause
bind = , XF86AudioNext, exec, playerctl next
bind = , XF86AudioPrev, exec, playerctl previous

# 截图 (选择区域到剪贴板)
bind = $mainMod SHIFT, S, exec, grim -g "$(slurp)" - | wl-copy

# 锁定屏幕
bind = $mainMod, L, exec, hyprlock

# 退出 Hyprland
bind = $mainMod SHIFT, E, exec, ~/.config/hypr/powermenu.sh

##############################
### 窗口和工作区配置 ###
##############################

# 窗口规则和工作区规则配置
# 参见 https://wiki.hyprland/Configuring/Window-Rules/ 获取更多窗口规则信息
# 参见 https://wiki.hyprland/Configuring/Workspace-Rules/ 获取工作区规则信息

# 示例窗口规则
# windowrule = float,class:^(kitty)$,title:^(kitty)$  # 让 kitty 终端应用以浮动窗口形式打开

# 忽略应用程序的最大化请求。您可能会喜欢这个功能。
# 对所有类别的应用程序抑制最大化事件
windowrule = suppressevent maximize, class:.*

# 修复 XWayland 应用程序的拖动问题
# 此规则针对特定条件的 XWayland 窗口禁用焦点获取：
# - 类名为空 (class:^$)
# - 标题为空 (title:^$)
# - 是 XWayland 应用程序 (xwayland:1)
# - 处于浮动状态 (floating:1)
# - 不是全屏状态 (fullscreen:0)
# - 不是固定状态 (pinned:0)
windowrule = nofocus,class:^$,title:^$,xwayland:1,floating:1,fullscreen:0,pinned:0

windowrulev2 = float,class:Impala
windowrulev2 = size 800 600,class:Impala
windowrulev2 = center,class:Impala
